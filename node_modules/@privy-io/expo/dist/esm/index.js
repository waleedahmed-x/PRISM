import{a as O,c as S,d as k,e as _,f as U,g as $,h as ee,i as re,j as te,k as g,l as Ae,m as Me,n as Re,o as He,p as pe,q as Te,r as Ie,s as Ge,t as je,u as De}from"./chunk-OFYWAU3A.js";export*from"@privy-io/js-sdk-core";import{useCallback as M,useContext as ne}from"react";import{PrivyClientError as ie}from"@privy-io/js-sdk-core";var Be=e=>{let{user:c,client:m,setSiweState:o,siweState:s}=ne(g),l=M(u=>{var a;let h=k(u);return o({status:"error",error:h}),(a=e==null?void 0:e.onError)==null||a.call(e,h),h},[e==null?void 0:e.onError]),r=M(d=>S(void 0,[d],function*({wallet:u,from:{domain:h,uri:a}}){var t;try{o({status:"generating-message"});let i=yield m.auth.siwe.init(u,h,a);return o({status:"awaiting-signature"}),(t=e==null?void 0:e.onGenerateMessage)==null||t.call(e,i.message),i.message}catch(i){throw l(i)}}),[m,l,e==null?void 0:e.onGenerateMessage]),n=M(a=>S(void 0,[a],function*({signature:u,messageOverride:h}){var d;try{if(!c)throw new ie({code:"attempted_link_siwe_before_logged_in",error:"Must be logged in to link a wallet, Use `useLoginWithSiwe` to login with a wallet"});o({status:"submitting-signature"});let t=yield m.auth.siwe.linkWithSiwe(u,void 0,h);return o({status:"done"}),(d=e==null?void 0:e.onSuccess)==null||d.call(e,t),t}catch(t){throw l(t)}}),[c,m,l,e==null?void 0:e.onSuccess]);return{generateSiweMessage:r,linkWithSiwe:n,state:s}};import{useCallback as R,useContext as ae}from"react";import{PrivyClientError as oe}from"@privy-io/js-sdk-core";var $e=e=>{let{user:c,client:m,setSiweState:o,siweState:s}=ae(g),l=R(u=>{var a;let h=k(u);return o({status:"error",error:h}),(a=e==null?void 0:e.onError)==null||a.call(e,h),h},[e==null?void 0:e.onError]),r=R(d=>S(void 0,[d],function*({wallet:u,from:{domain:h,uri:a}}){var t;try{o({status:"generating-message"});let i=yield m.auth.siwe.init(u,h,a);return o({status:"awaiting-signature"}),(t=e==null?void 0:e.onGenerateMessage)==null||t.call(e,i.message),i.message}catch(i){throw l(i)}}),[m,l,e==null?void 0:e.onGenerateMessage]);return{loginWithSiwe:R(d=>S(void 0,[d],function*({signature:u,messageOverride:h,disableSignup:a}){var t;try{if(c)throw new oe({code:"attempted_login_with_siwe_while_already_logged_in",error:"Already logged in, use `useLinkWithSiwe` if you are trying to link a wallet to an existing account"});o({status:"submitting-signature"});let i=yield m.auth.siwe.loginWithSiwe(u,void 0,h,a?"no-signup":"login-or-sign-up");return o({status:"done"}),(t=e==null?void 0:e.onSuccess)==null||t.call(e,i.user,i.is_new_user),i.user}catch(i){throw l(i)}}),[c,m,l,e==null?void 0:e.onSuccess]),generateSiweMessage:r,state:s}};import{useCallback as q,useContext as se}from"react";import{PrivyClientError as ce}from"@privy-io/js-sdk-core";var or=e=>{let{user:c,client:m}=se(g),o=q(l=>{var n;let r=k(l);return(n=e==null?void 0:e.onError)==null||n.call(e,r),r},[e==null?void 0:e.onError]);return{unlinkWallet:q(r=>S(void 0,[r],function*({address:l}){var n;try{if(!c)throw new ce({code:"attempted_unlink_siwe_before_logged_in",error:"Must be logged in to unlink a wallet, Use `useLoginWithSiwe` to login with a wallet"});let u=yield m.auth.siwe.unlinkWallet(l);return(n=e==null?void 0:e.onSuccess)==null||n.call(e,u),u}catch(u){throw o(u)}}),[c,m,o,e==null?void 0:e.onSuccess])}};import{useCallback as H,useContext as le,useState as ue}from"react";import{PrivyClientError as B}from"@privy-io/js-sdk-core";var gr=e=>{let[c,m]=ue(""),{user:o,client:s,otpState:l,setOtpState:r}=le(g),n=H(a=>{var t;let d=k(a);return r({status:"error",error:d}),(t=e==null?void 0:e.onError)==null||t.call(e,d),d},[e==null?void 0:e.onError]),u=H(d=>S(void 0,[d],function*({email:a}){var t;m(a);try{r({status:"sending-code"});let i=yield s.auth.email.sendCode(a);return r({status:"awaiting-code-input"}),(t=e==null?void 0:e.onSendCodeSuccess)==null||t.call(e,{email:a}),i}catch(i){return n(i),{success:!1}}}),[s,n,e==null?void 0:e.onSendCodeSuccess]),h=H(t=>S(void 0,[t],function*({code:a,email:d}){var i;try{if(!o)throw new B({code:"attempted_link_email_before_logged_in",error:"Must be logged in to link an email, Use `useLoginWithEmail` to login with email"});let f=d||c;if(!f)throw new B({code:"attempted_submit_otp_before_sending",error:"Must `sendCode` with a valid email before calling `linkWithCode`"});r({status:"submitting-code"});let y=yield s.auth.email.linkWithCode(f,a);return r({status:"done"}),(i=e==null?void 0:e.onLinkSuccess)==null||i.call(e,y),y}catch(f){n(f)}}),[o,s,c,n,e==null?void 0:e.onLinkSuccess]);return{sendCode:u,linkWithCode:h,state:l}};import{useCallback as p,useContext as me,useState as de}from"react";import{PrivyClientError as J}from"@privy-io/js-sdk-core";var Wr=e=>{let[c,m]=de(""),{user:o,client:s,otpState:l,setOtpState:r}=me(g),n=p(a=>{var t;let d=k(a);return r({status:"error",error:d}),(t=e==null?void 0:e.onError)==null||t.call(e,d),d},[e==null?void 0:e.onError]),u=p(d=>S(void 0,[d],function*({email:a}){var t;m(a);try{r({status:"sending-code"});let i=yield s.auth.email.sendCode(a);return r({status:"awaiting-code-input"}),(t=e==null?void 0:e.onSendCodeSuccess)==null||t.call(e,{email:a}),i}catch(i){return n(i),{success:!1}}}),[s,n,e==null?void 0:e.onSendCodeSuccess]),h=p(i=>S(void 0,[i],function*({code:a,email:d,disableSignup:t}){var f;try{if(o)throw new J({code:"attempted_login_with_email_while_already_logged_in",error:"Already logged in, use `useLinkWithEmail` if you are trying to link an email to an existing account"});let y=d||c;if(!y)throw new J({code:"attempted_submit_otp_before_sending",error:"Must `sendCode` with a valid email before calling `loginWithCode`"});r({status:"submitting-code"});let w=yield s.auth.email.loginWithCode(y,a,t?"no-signup":"login-or-sign-up");return r({status:"done"}),(f=e==null?void 0:e.onLoginSuccess)==null||f.call(e,w.user,w.is_new_user),w==null?void 0:w.user}catch(y){n(y)}}),[o,s,c,n,e==null?void 0:e.onLoginSuccess]);return{sendCode:u,loginWithCode:h,state:l}};import{useCallback as T,useContext as ge,useState as he}from"react";import{PrivyClientError as K}from"@privy-io/js-sdk-core";var xr=e=>{let[c,m]=he(""),{user:o,client:s,otpState:l,setOtpState:r}=ge(g),n=T(a=>{var t;let d=k(a);return r({status:"error",error:d}),(t=e==null?void 0:e.onError)==null||t.call(e,d),d},[e==null?void 0:e.onError]),u=T(d=>S(void 0,[d],function*({phone:a}){var t;m(a);try{r({status:"sending-code"});let i=yield s.auth.phone.sendCode(a);return r({status:"awaiting-code-input"}),(t=e==null?void 0:e.onSendCodeSuccess)==null||t.call(e,{phone:a}),i}catch(i){return n(i),{success:!1}}}),[s,n,e==null?void 0:e.onSendCodeSuccess]),h=T(t=>S(void 0,[t],function*({code:a,phone:d}){var i;try{if(!o)throw new K({code:"attempted_link_sms_before_logged_in",error:"Must be logged in to link a phone number, Use `useLoginWithSMS` to login with a phone number"});if(!(d||c))throw new K({code:"attempted_submit_otp_before_sending",error:"Must `sendCode` with a valid phone number before calling `linkWithCode`"});r({status:"submitting-code"});let y=yield s.auth.phone.linkWithCode(d||c,a);return r({status:"done"}),(i=e==null?void 0:e.onLinkSuccess)==null||i.call(e,y),y}catch(f){n(f)}}),[o,s,c,n,e==null?void 0:e.onLinkSuccess]);return{sendCode:u,linkWithCode:h,state:l}};import{useCallback as I,useContext as Se,useState as ke}from"react";import{PrivyClientError as Q}from"@privy-io/js-sdk-core";var Rr=e=>{let[c,m]=ke(""),{user:o,client:s,otpState:l,setOtpState:r}=Se(g),n=I(a=>{var t;let d=k(a);return r({status:"error",error:d}),(t=e==null?void 0:e.onError)==null||t.call(e,d),d},[e==null?void 0:e.onError]),u=I(d=>S(void 0,[d],function*({phone:a}){var t;m(a);try{r({status:"sending-code"});let i=yield s.auth.phone.sendCode(a);return r({status:"awaiting-code-input"}),(t=e==null?void 0:e.onSendCodeSuccess)==null||t.call(e,{phone:a}),i}catch(i){return n(i),{success:!1}}}),[s,n,e==null?void 0:e.onSendCodeSuccess]),h=I(i=>S(void 0,[i],function*({code:a,phone:d,disableSignup:t}){var f;try{if(o)throw new Q({code:"attempted_login_with_sms_while_already_logged_in",error:"Already logged in, use `useLinkWithSMS` if you are trying to link a phone number to an existing account"});if(!(d||c))throw new Q({code:"attempted_submit_otp_before_sending",error:"Must `sendCode` with a valid phone number before calling `loginWithCode`"});r({status:"submitting-code"});let w=yield s.auth.phone.loginWithCode(d||c,a,t?"no-signup":"login-or-sign-up");return r({status:"done"}),(f=e==null?void 0:e.onLoginSuccess)==null||f.call(e,w.user,w.is_new_user),w==null?void 0:w.user}catch(y){n(y)}}),[o,s,c,n,e==null?void 0:e.onLoginSuccess]);return{sendCode:u,loginWithCode:h,state:l}};import*as F from"expo-linking";import{useCallback as G,useContext as fe,useRef as we}from"react";import{PrivyClientError as L}from"@privy-io/js-sdk-core";var Dr=e=>{let{appState:c,getCurrentAppState:m}=U(),{client:o,user:s,farcasterState:l,setFarcasterState:r}=fe(g),n=we(!1),u=G(d=>{var i;let t=k(d);return r({status:"error",error:t}),(i=e==null?void 0:e.onError)==null||i.call(e,t),t},[e==null?void 0:e.onError,r]),h=G(()=>{n.current=!0},[]);return{linkWithFarcaster:G((f,...y)=>S(void 0,[f,...y],function*({relyingParty:d,redirectUrl:t},i={pollAttempts:10,pollIntervalMs:1e3}){var w;try{if(n.current=!1,!s)throw new L({code:"attempted_link_farcaster_before_logged_in",error:"Must be logged in to link a Farcaster account."});r({status:"generating-uri"});let{connect_uri:E,channel_token:W}=yield o.auth.farcaster.initializeAuth({relyingParty:d,redirectUrl:F.createURL(t!=null?t:"/")});if(!E)throw new L({code:"failed_to_generate_farcaster_uri",error:"Failed to generate farcaster uri"});if(!W)throw new L({code:"failed_to_generate_farcaster_channel_token",error:"Failed to generate farcaster channel token"});yield F.openURL(E),r({status:"polling-status"});let C=0;for(;C<i.pollAttempts;){if(n.current)throw new L({code:"farcaster_polling_canceled",error:"Farcaster polling canceled"});if(c.current!=="active"&&m()!=="active"){yield _(i.pollIntervalMs);continue}let b=yield o.auth.farcaster.getFarcasterStatus({channel_token:W});if(b.state==="completed"){r({status:"submitting-token"});let v=yield o.auth.farcaster.link(O({channel_token:W},b));return r({status:"done"}),(w=e==null?void 0:e.onSuccess)==null||w.call(e,v),v}C++,yield _(i.pollIntervalMs)}throw new L({code:"farcaster_polling_timeout",error:"Farcasting polling timed out"})}catch(E){throw u(E)}}),[o,e==null?void 0:e.onSuccess,u,r,s]),state:l,cancel:h}};import{useCallback as X,useContext as ye}from"react";var Jr=e=>{let{client:c}=ye(g),m=X(s=>{var r;let l=k(s);return(r=e==null?void 0:e.onError)==null||r.call(e,l),l},[e==null?void 0:e.onError]);return{unlinkFarcaster:X(l=>S(void 0,[l],function*({fid:s}){var r;try{let n=yield c.auth.farcaster.unlink({fid:s});return(r=e==null?void 0:e.onSuccess)==null||r.call(e,n),n}catch(n){throw m(n)}}),[c,e==null?void 0:e.onSuccess,m])}};import*as P from"expo-linking";import{useCallback as N,useContext as We,useRef as Ee}from"react";import{PrivyClientError as x}from"@privy-io/js-sdk-core";var et=e=>{let{appState:c,getCurrentAppState:m}=U(),{client:o,user:s,farcasterState:l,setFarcasterState:r}=We(g),n=Ee(!1),u=N(d=>{var i;let t=k(d);return r({status:"error",error:t}),(i=e==null?void 0:e.onError)==null||i.call(e,t),t},[e==null?void 0:e.onError,r]),h=N(()=>{n.current=!0},[]);return{loginWithFarcaster:N((y,...w)=>S(void 0,[y,...w],function*({relyingParty:d,redirectUrl:t,disableSignup:i},f={pollAttempts:10,pollIntervalMs:1e3}){var E;try{if(n.current=!1,s)throw new x({code:"attempted_login_with_farcaster_while_already_logged_in",error:"Already logged in, use `useLinkWithFarcaster` if you are trying to link farcaster to an existing account"});r({status:"generating-uri"});let{connect_uri:W,channel_token:C}=yield o.auth.farcaster.initializeAuth({relyingParty:d,redirectUrl:P.createURL(t!=null?t:"/")});if(!W)throw new x({code:"failed_to_generate_farcaster_uri",error:"Failed to generate farcaster uri"});if(!C)throw new x({code:"failed_to_generate_farcaster_channel_token",error:"Failed to generate farcaster channel token"});yield P.openURL(W),r({status:"polling-status"});let b=0;for(;b<f.pollAttempts;){if(n.current)throw new x({code:"farcaster_polling_canceled",error:"Farcaster polling canceled"});if(c.current!=="active"&&m()!=="active"){yield _(f.pollIntervalMs);continue}let v=yield o.auth.farcaster.getFarcasterStatus({channel_token:C});if(v.state==="completed"){r({status:"submitting-token"});let A=yield o.auth.farcaster.authenticate(O({channel_token:C,mode:i?"no-signup":"login-or-sign-up"},v));return r({status:"done"}),(E=e==null?void 0:e.onSuccess)==null||E.call(e,A.user,A.is_new_user),A.user}b++,yield _(f.pollIntervalMs)}throw new x({code:"farcaster_polling_timeout",error:"Farcasting polling timed out"})}catch(W){throw u(W)}}),[o,u,e==null?void 0:e.onSuccess,r,s,c]),state:l,cancel:h}};import{useCallback as Y,useContext as Ce}from"react";var ot=e=>{let{client:c}=Ce(g),m=Y(s=>{var r;let l=k(s);return(r=e==null?void 0:e.onError)==null||r.call(e,l),l},[e==null?void 0:e.onError]);return{unlinkOAuth:Y(r=>S(void 0,[r],function*({provider:s,subject:l}){var n;try{let u=yield c.auth.oauth.unlink(s,l);return(n=e==null?void 0:e.onSuccess)==null||n.call(e,u),u}catch(u){throw m(u)}}),[c,e==null?void 0:e.onSuccess,m])}};import{useEffect as be}from"react";import{useContext as _e,useEffect as z}from"react";var V=(e={})=>{let{wallet:c,createWalletCallbacks:m,recoverWalletCallbacks:o,setWalletRecoveryCallbacks:s}=_e(g),{onCreateWalletSuccess:l,onCreateWalletError:r,onRecoverWalletError:n,onRecoverWalletSuccess:u,onSetWalletRecoverySuccess:h,onSetWalletRecoveryError:a}=e;return z(()=>{m.current={onSuccess:l,onError:r}},[l,r]),z(()=>{o.current={onSuccess:u,onError:n}},[u,n]),z(()=>{s.current={onSuccess:h,onError:a}},[u,n]),c};var ht=({onStateChange:e})=>{let c=V();return be(()=>{e(c)},[c])};import{useContext as ve}from"react";var wt=()=>{let{getIdentityToken:e}=ve(g);return{getIdentityToken:e}};import{useContext as Le,useEffect as Z}from"react";var xe=(e={})=>{let{solanaWallet:c,createSolanaWalletCallbacks:m,recoverSolanaWalletCallbacks:o}=Le(g),{onCreateWalletSuccess:s,onCreateWalletError:l,onRecoverWalletError:r,onRecoverWalletSuccess:n}=e;return Z(()=>{m.current={onSuccess:s,onError:l}},[s,l]),Z(()=>{o.current={onSuccess:n,onError:r}},[n,r]),c};import{useContext as Oe}from"react";var Ue=()=>{let{client:e}=Oe(g);return e};import{useContext as Fe}from"react";var Pe=()=>{let{user:e,isReady:c,logout:m,getAccessToken:o}=Fe(g);return{user:e,isReady:c,logout:m,getAccessToken:o}};export{g as PrivyContext,Me as PrivyProvider,te as SecureStorageAdapter,Ae as getAccessToken,je as hasError,Re as isConnected,pe as isConnecting,Ge as isCreating,Te as isDisconnected,Ie as isNotCreated,He as isReconnecting,De as needsRecovery,xe as useEmbeddedSolanaWallet,V as useEmbeddedWallet,ht as useEmbeddedWalletStateChange,wt as useIdentityToken,gr as useLinkEmail,xr as useLinkSMS,Dr as useLinkWithFarcaster,ee as useLinkWithOAuth,Be as useLinkWithSiwe,Wr as useLoginWithEmail,et as useLoginWithFarcaster,$ as useLoginWithOAuth,Rr as useLoginWithSMS,$e as useLoginWithSiwe,re as useOAuthFlow,Pe as usePrivy,Ue as usePrivyClient,Jr as useUnlinkFarcaster,ot as useUnlinkOAuth,or as useUnlinkWallet};
