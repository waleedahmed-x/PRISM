{"version":3,"file":"Session.js","sources":["../src/Session.ts"],"sourcesContent":[null],"names":["TOKEN_STORAGE_KEY","TOKEN_COOKIE_KEY","REFRESH_TOKEN_STORAGE_KEY","REFRESH_TOKEN_COOKIE_KEY","IDENTITY_TOKEN_STORAGE_KEY","IDENTITY_TOKEN_COOKIE_KEY","SESSION_COOKIE_KEY","FORKED_TOKEN_STORAGE_KEY","events","Session","EventEmitter","static","_storage","_isUsingServerCookies","constructor","o","super","this","storage","isUsingServerCookies","getToken","token","get","Token","value","error","console","destroyLocalState","reason","getRefreshToken","refreshToken","getIdentityToken","identityToken","getForkedToken","forkedToken","mightHaveServerCookies","sessionToken","Cookies","undefined","length","hasRefreshCredentials","hasRecoveryCredentials","tokenIsActive","tokenRaw","parse","isExpired","opts","res","Promise","all","del","clearForkedToken","emit","storeToken","previousToken","put","exp","expiration","set","sameSite","secure","expires","Date","cookiesEnabled","remove","storeRefreshToken","storeIdentityToken","previousIdentityToken"],"mappings":"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"}